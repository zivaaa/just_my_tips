webpackJsonp([1],{"+OoM":function(t,s){},"56rE":function(t,s){},"6n7v":function(t,s){},AGCy:function(t,s){},AQUC:function(t,s){},DPrN:function(t,s){},M8J5:function(t,s){},NHnr:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var n=e("7+uW"),o={name:"Modal",props:{disposable:Boolean,show:Boolean},mounted:function(){console.log("mounted"),this.disposable||(this.showing=!!this.show)},data:function(){return{showing:!1}},methods:{showModal:function(){this.showing=!0},hideModal:function(){this.showing=!1}},watch:{show:function(t,s){this.disposable||(this.showing=t)}}},a={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("transition",{attrs:{name:"fade"}},[t.showing?e("div",{staticClass:"modal"},[e("div",{staticClass:"modal-content"},[t.disposable?e("div",{staticClass:"modal-close-btn",on:{click:t.hideModal}},[t._v("X")]):t._e(),t._v(" "),e("div",{staticClass:"modal-header"},[t._t("header")],2),t._v(" "),e("div",{staticClass:"modal-body",attrs:{slot:""},slot:"default"},[t._t("default")],2),t._v(" "),e("div",{staticClass:"modal-footer",attrs:{slot:"footer"},slot:"footer"},[t._t("footer")],2)])]):t._e()])},staticRenderFns:[]};var i=e("VU/8")(o,a,!1,function(t){e("i8oa")},null,null).exports,r={name:"LoginForm",methods:{submit:function(){console.log("submit"),this.$refs.usernameInput.value&&this.$emit("onSubmit",{username:this.$refs.usernameInput.value})}}},c={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"form"},[e("div",{staticClass:"form-control"},[e("input",{ref:"usernameInput",attrs:{type:"text",placeholder:"Username"},on:{keyup:function(s){return"button"in s||!t._k(s.keyCode,"enter",13,s.key,"Enter")?t.submit(s):null}}})]),t._v(" "),e("div",{staticClass:"form-control"},[e("button",{on:{click:t.submit}},[t._v("Submit")])])])},staticRenderFns:[]};var u=e("VU/8")(r,c,!1,function(t){e("56rE")},null,null).exports,l=e("OLcD"),h=e.n(l),d={name:"HeaderNonAuth",components:{LoginForm:u,Modal:i},methods:{onLogin:function(){this.$refs.loginModal.showModal()},onSubmit:function(t){console.log("login fired"),this.$store.dispatch(h.a.ACTION_LOGIN,t)}}},m={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"non_auth"},[s("button",{staticClass:"btn_login",on:{click:this.onLogin}},[this._v("Login")]),this._v(" "),s("modal",{ref:"loginModal",attrs:{disposable:!0}},[s("template",{slot:"header"},[s("p",[this._v("Login form")])]),this._v(" "),[s("login-form",{on:{onSubmit:this.onSubmit}})]],2)],1)},staticRenderFns:[]};var f=e("VU/8")(d,m,!1,function(t){e("o7An")},null,null).exports,_={name:"HeaderAuth",computed:{userName:function(){return this.$store.state.user?this.$store.state.user.username:"O_o?"}},methods:{onLogout:function(){this.$store.dispatch(h.a.ACTION_LOGOUT)}}},p={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"auth"},[s("div",[s("p",[this._v("Logged as : "+this._s(this.userName))])]),this._v(" "),s("button",{staticClass:"btn_logout",on:{click:this.onLogout}},[this._v("Logout")])])},staticRenderFns:[]};var v={name:"VHeader",components:{HeaderAuth:e("VU/8")(_,p,!1,function(t){e("6n7v")},null,null).exports,HeaderNonAuth:f}},j={render:function(){var t=this.$createElement,s=this._self._c||t;return s("header",[s("div",{staticClass:"head_wrap"},[this._m(0),this._v(" "),s("div",{staticClass:"header-content"},[this.$store.state.authenticated?s("header-auth"):s("header-non-auth")],1)])])},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"logo-wrap"},[s("p",[this._v("ZChat")])])}]};var g=e("VU/8")(v,j,!1,function(t){e("DPrN")},null,null).exports,T={render:function(){var t=this.$createElement,s=this._self._c||t;return s("footer",[s("h2",[this._v("Status: ("+this._s(this.status)+")")])])},staticRenderFns:[]};var S={name:"App",components:{Modal:i,VFooter:e("VU/8")({props:["status"],name:"VFooter"},T,!1,function(t){e("Z6+v")},null,null).exports,VHeader:g},mounted:function(){this.$store.state.connector.init("http://127.0.0.1:3000",this.$store)},computed:{status:function(){switch(this.$store.state.status){case h.a.STATUS_NORMAL:return"idle";case h.a.STATUS_LOADING:return"loading";default:return"unknown"}},needBlockScreen:function(){return this.$store.state.status==h.a.STATUS_LOADING}}},E={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"app"}},[e("v-header"),t._v(" "),e("router-view"),t._v(" "),e("v-footer",{attrs:{status:t.status}}),t._v(" "),e("modal",{attrs:{disposable:!1,show:t.needBlockScreen}},[e("template",{slot:"header"},[e("p",[t._v("Loading...")])]),t._v(" "),[e("div",{staticClass:"spinner-wrap"},[e("div",{staticClass:"cheap-spinner"},[e("p",[t._v("?")])])])]],2)],1)},staticRenderFns:[]};var A=e("VU/8")(S,E,!1,function(t){e("AQUC")},null,null).exports,O=e("/ocq"),C={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"content welcome"},[s("h1",[this._v("Welcome to ZChat!")])])}]};var M=e("VU/8")({name:"PageWelcome"},C,!1,function(t){e("+OoM")},null,null).exports,N=e("PJh5"),U=e.n(N),k={name:"Message",props:{my:{type:Boolean,required:!0},message:{type:Object,required:!0}},computed:{username:function(){return this.message.user?this.message.user.username:"?"},messageAt:function(){return U()(this.message.date).format("DD.MM.YY HH:mm:ss")}}},w={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{class:{chat_message:!0,my:t.my}},[e("div",{staticClass:"message_wrapper"},[e("div",{staticClass:"author"},[t._v(t._s(t.username)+":")]),t._v(" "),e("div",{staticClass:"text"},[e("p",[t._v(t._s(t.message.message))]),t._v(" "),e("p",{staticClass:"time"},[t._v(t._s(t.messageAt))])])])])},staticRenderFns:[]};var I={components:{Message:e("VU/8")(k,w,!1,function(t){e("Px6v")},null,null).exports},props:{me:Object,messages:Array},name:"MessageList",data:function(){return{}},watch:{messages:function(t){this.$nextTick(function(){this.$emit("onMessagesChanged",t)})}},methods:{isMyMessage:function(t){return!!this.me&&this.me.id==t.user.id}}},b={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"message_list"},t._l(t.messages,function(s,n,o){return e("message",{key:o,attrs:{message:s,my:t.isMyMessage(s)}})}),1)},staticRenderFns:[]};var L=e("VU/8")(I,b,!1,function(t){e("AGCy")},null,null).exports,y={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"chat_input form"},[e("div",{staticClass:"form-control"},[e("textarea",{ref:"input",attrs:{placeholder:"Enter something... (Ctrl + Enter)"},on:{onSend:t.onSendMessage,keyup:function(s){return("button"in s||!t._k(s.keyCode,"enter",13,s.key,"Enter"))&&s.ctrlKey?t.onSendMessage(s):null}}})]),t._v(" "),e("div",{staticClass:"form-control"},[e("button",{on:{click:t.onSendMessage}},[t._v("Send")])])])},staticRenderFns:[]};var x={name:"PageChat",components:{ChatInput:e("VU/8")({name:"ChatInput",props:{},data:function(){return{}},methods:{onSendMessage:function(){this.$refs.input.value.trim()&&(this.$emit("onSend",this.$refs.input.value.trim()),this.$refs.input.value="")}}},y,!1,function(t){e("u+5v")},null,null).exports,MessageList:L},methods:{onSendMessage:function(t){this.$store.dispatch(h.a.ACTION_SEND_MESSAGE,t)},onMessagesChanged:function(t){var s=this.$refs.chat_list_wrapper.scrollHeight-this.$refs.chat_list_wrapper.clientHeight;this.$refs.chat_list_wrapper.scrollTop=s}}},R={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"content chat"},[s("div",{staticClass:"chat_wrapper"},[s("div",{ref:"chat_list_wrapper",staticClass:"chat_list_wrapper"},[s("div",{ref:"chat_list_content",staticClass:"chat_list_content",attrs:{id:"test"}},[s("message-list",{attrs:{me:this.$store.state.user,messages:this.$store.state.messages},on:{onMessagesChanged:this.onMessagesChanged}})],1)]),this._v(" "),s("chat-input",{on:{onSend:this.onSendMessage}})],1)])},staticRenderFns:[]};var G=e("VU/8")(x,R,!1,function(t){e("M8J5")},null,null).exports,z=e("k56e"),F=e.n(z);var V,$,H=e("bOdI"),D=e.n(H),P=e("NYxO"),q=e("pFYg"),W=e.n(q),B=e("Zrlr"),X=e.n(B),Z=function t(s,e){X()(this,t),"object"==(void 0===s?"undefined":W()(s))?(this.id=s.id,this.username=s.username):(this.id=s,this.username=e)},J=function t(s,e,n){X()(this,t),this.message=s,this.user=e,this.date=n||new Date},K=e("wxAW"),Q=e.n(K),Y=function(){function t(){X()(this,t),this.store=null,this.socket=null,this.initiated=!1,this.url=""}return Q()(t,[{key:"init",value:function(t,s){if(this.initiated)throw new Error("Connector is being initiated already!");this.url=t,this.initiated=!0,this.store=s,this.store.dispatch(h.a.ACTION_SET_STATUS,h.a.STATUS_LOADING),this.socket=io(this.url),this._listen()}},{key:"_listen",value:function(){var t=this;this.socket.on("connected",function(){console.info("connected"),t.store.dispatch(h.a.ACTION_SET_STATUS,h.a.STATUS_NORMAL)}),this.socket.on("chat_message",function(s){console.info("chat_message",s),t.store.dispatch(h.a.ACTION_RECEIVE_MESSAGE,s)}),this.socket.on("disconnected",function(){console.info("disconnected")})}},{key:"doLogin",value:function(t,s){this.socket.emit("login",t,function(t,e){t?console.error("doLogin error",t):console.info("doLogin",e),s&&s(t,e)})}},{key:"doLogout",value:function(){this.socket.emit("logout")}},{key:"doSendMessage",value:function(t){this.socket.emit("chat_message",t)}}]),t}();n.a.use(P.a);var tt={authenticated:!1,user:null,status:l.STATUS_NORMAL,connector:new Y,messages:[]},st=(V={},D()(V,l.MUTATION_LOGIN,function(t,s){t.authenticated=!0,t.user=s,at.push({name:F.a.CHAT})}),D()(V,l.MUTATION_LOGOUT,function(t){t.authenticated=!1,t.user=null,at.push({name:F.a.WELCOME})}),D()(V,l.MUTATION_SET_STATUS,function(t,s){t.status=s}),D()(V,l.MUTATION_RECEIVE_MESSAGE,function(t,s){t.messages.push(s)}),V),et=($={},D()($,l.ACTION_LOGIN,function(t,s){t.commit(l.MUTATION_SET_STATUS,l.STATUS_LOADING),t.state.connector.doLogin(s,function(s,e){s?t.commit(l.MUTATION_SET_STATUS,l.STATUS_ERROR):(t.commit(l.MUTATION_SET_STATUS,l.STATUS_NORMAL),t.commit(l.MUTATION_LOGIN,new Z(e.id,e.username)))})}),D()($,l.ACTION_LOGOUT,function(t){t.state.connector.doLogout(),t.commit(l.MUTATION_LOGOUT)}),D()($,l.ACTION_SET_STATUS,function(t,s){t.commit(l.MUTATION_SET_STATUS,s)}),D()($,l.ACTION_SEND_MESSAGE,function(t,s){t.state.connector.doSendMessage(s)}),D()($,l.ACTION_RECEIVE_MESSAGE,function(t,s){t.commit(l.MUTATION_RECEIVE_MESSAGE,new J(s.message,new Z(s.user)))}),$),nt=new P.a.Store({state:tt,getters:{},actions:et,mutations:st});n.a.use(O.a);var ot=new O.a({routes:[{path:"/",name:F.a.WELCOME,component:M,meta:{middleware:[]}},{path:"/chat",name:F.a.CHAT,component:G,meta:{middleware:[function(t,s,e,n){return!!n.state.authenticated||e({name:F.a.WELCOME})}]}}]});ot.beforeEach(function(t,s,e){if(t.meta.middleware)try{t.meta.middleware.some(function(n){return!n(t,s,e,nt)})?console.warn("route has being handled already"):(console.warn("route access granted"),e())}catch(t){console.error(t.message),e(t)}else e()});var at=ot;n.a.config.productionTip=!1,new n.a({el:"#app",router:at,store:nt,components:{App:A},template:"<App/>"})},OLcD:function(t,s){t.exports.ACTION_LOGIN="login",t.exports.ACTION_LOGOUT="logout",t.exports.ACTION_SET_STATUS="set_status",t.exports.ACTION_SEND_MESSAGE="send_message",t.exports.ACTION_RECEIVE_MESSAGE="receive_message",t.exports.MUTATION_LOGIN="LOGIN",t.exports.MUTATION_LOGOUT="LOGOUT",t.exports.MUTATION_SET_STATUS="SET_STATUS",t.exports.MUTATION_SEND_MESSAGE="SEND_MESSAGE",t.exports.MUTATION_RECEIVE_MESSAGE="RECEIVE_MESSAGE",t.exports.STATUS_LOADING=1,t.exports.STATUS_NORMAL=0,t.exports.STATUS_ERROR=-1},Px6v:function(t,s){},"Z6+v":function(t,s){},i8oa:function(t,s){},k56e:function(t,s){t.exports.WELCOME="welcome",t.exports.CHAT="chat"},o7An:function(t,s){},"u+5v":function(t,s){},uslO:function(t,s,e){var n={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ku":"kI9l","./ku.js":"kI9l","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function o(t){return e(a(t))}function a(t){var s=n[t];if(!(s+1))throw new Error("Cannot find module '"+t+"'.");return s}o.keys=function(){return Object.keys(n)},o.resolve=a,t.exports=o,o.id="uslO"}},["NHnr"]);
//# sourceMappingURL=app.b26495bd4c886716e402.js.map